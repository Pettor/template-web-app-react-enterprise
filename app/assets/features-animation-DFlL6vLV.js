import{S as A,H as V,F as a,an as x,q as E,a3 as C,u as F,o as f,a4 as P}from"./add-dom-event-Cz7ramGW.js";import{ee as I,W as O,ba as k,f as S}from"./index-BkDfcGXb.js";const G=(e,t)=>t.isSVG??I(e)?new A(t):new V(t,{allowProjection:e!==O.Fragment});class H extends a{constructor(t){super(t),t.animationState||(t.animationState=x(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();k(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let T=0;class M extends a{constructor(){super(...arguments),this.id=T++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===s)return;const o=this.node.animationState.setActive("exit",!t);n&&!t&&o.then(()=>{n(this.id)})}mount(){const{register:t,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const N={animation:{Feature:H},exit:{Feature:M}};function p(e){return{point:{x:e.pageX,y:e.pageY}}}const z=e=>t=>E(t)&&e(t,p(t));function v(e,t,n){const{props:s}=e;e.animationState&&s.whileHover&&e.animationState.setActive("whileHover",n==="Start");const o="onHover"+n,i=s[o];i&&S.postRender(()=>i(t,p(t)))}class B extends a{mount(){const{current:t}=this.node;t&&(this.unmount=C(t,(n,s)=>(v(this.node,s,"Start"),o=>v(this.node,o,"End"))))}unmount(){}}class L extends a{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=F(f(this.node.current,"focus",()=>this.onFocus()),f(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function b(e,t,n){const{props:s}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&s.whileTap&&e.animationState.setActive("whileTap",n==="Start");const o="onTap"+(n==="End"?"":n),i=s[o];i&&S.postRender(()=>i(t,p(t)))}class R extends a{mount(){const{current:t}=this.node;if(!t)return;const{globalTapTarget:n,propagate:s}=this.node.props;this.unmount=P(t,(o,i)=>(b(this.node,i,"Start"),(u,{success:c})=>b(this.node,u,c?"End":"Cancel")),{useGlobalTarget:n,stopPropagation:s?.tap===!1})}unmount(){}}const m=new WeakMap,h=new WeakMap,W=e=>{const t=m.get(e.target);t&&t(e)},y=e=>{e.forEach(W)};function D({root:e,...t}){const n=e||document;h.has(n)||h.set(n,{});const s=h.get(n),o=JSON.stringify(t);return s[o]||(s[o]=new IntersectionObserver(y,{root:e,...t})),s[o]}function _(e,t,n){const s=D(t);return m.set(e,n),s.observe(e),()=>{m.delete(e),s.unobserve(e)}}const j={some:0,all:1};class q extends a{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:s,amount:o="some",once:i}=t,u={root:n?n.current:void 0,rootMargin:s,threshold:typeof o=="number"?o:j[o]},c=d=>{const{isIntersecting:r}=d;if(this.isInView===r||(this.isInView=r,i&&!r&&this.hasEnteredView))return;r&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",r);const{onViewportEnter:g,onViewportLeave:w}=this.node.getProps(),l=r?g:w;l&&l(d)};return _(this.node.current,u,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(J(t,n))&&this.startObserver()}unmount(){}}function J({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const U={inView:{Feature:q},tap:{Feature:R},focus:{Feature:L},hover:{Feature:B}},K={renderer:G,...N,...U};export{z as a,N as b,G as c,K as d,p as e,U as g};
