import{$ as y,c as P,e as _,h as B}from"./focusSafely-uUZoqiSA.js";import{r as o,R as K,j as h}from"./iframe-rb5u8kG-.js";import{g as N,a as q,h as Q}from"./useFocusRing-CTo2e8po.js";import{f as Y,m as z}from"./chunk-BGEKJ4Q5-DzVAaTre.js";import{f as G}from"./chunk-EJDFNA7Y-C3S100eb.js";function ve(e,t,a){let r=y(()=>{a&&a(t)});o.useEffect(()=>{var n;let i=e==null||(n=e.current)===null||n===void 0?void 0:n.form;return i?.addEventListener("reset",r),()=>{i?.removeEventListener("reset",r)}},[e])}function C(e){if(!e)return;let t=!0;return a=>{let r={...a,preventDefault(){a.preventDefault()},isDefaultPrevented(){return a.isDefaultPrevented()},stopPropagation(){t=!0},continuePropagation(){t=!1},isPropagationStopped(){return t}};e(r),t&&a.stopPropagation()}}function H(e){return{keyboardProps:e.isDisabled?{}:{onKeyDown:C(e.onKeyDown),onKeyUp:C(e.onKeyUp)}}}let J=K.createContext(null);function W(e){let t=o.useContext(J)||{};B(t,e);let{ref:a,...r}=t;return r}function me(e,t){let{focusProps:a}=N(e),{keyboardProps:r}=H(e),n=P(a,r),i=W(t),d=e.isDisabled?{}:i,u=o.useRef(e.autoFocus);o.useEffect(()=>{u.current&&t.current&&_(t.current),u.current=!1},[t]);let c=e.excludeFromTabOrder?-1:0;return e.isDisabled&&(c=void 0),{focusableProps:P({...n,tabIndex:c},d)}}const j={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},A={...j,customError:!0,valid:!1},$={isInvalid:!1,validationDetails:j,validationErrors:[]},O=o.createContext({}),D="__formValidationState"+Date.now();function $e(e){if(e[D]){let{realtimeValidation:t,displayValidation:a,updateValidation:r,resetValidation:n,commitValidation:i}=e[D];return{realtimeValidation:t,displayValidation:a,updateValidation:r,resetValidation:n,commitValidation:i}}return X(e)}function X(e){let{isInvalid:t,validationState:a,name:r,value:n,builtinValidation:i,validate:d,validationBehavior:u="aria"}=e;a&&(t||(t=a==="invalid"));let c=t!==void 0?{isInvalid:t,validationErrors:[],validationDetails:A}:null,s=o.useMemo(()=>{if(!d||n==null)return null;let f=Z(d,n);return R(f)},[d,n]);i?.validationDetails.valid&&(i=void 0);let l=o.useContext(O),v=o.useMemo(()=>r?Array.isArray(r)?r.flatMap(f=>I(l[f])):I(l[r]):[],[l,r]),[m,T]=o.useState(l),[M,p]=o.useState(!1);l!==m&&(T(l),p(!1));let V=o.useMemo(()=>R(M?[]:v),[M,v]),w=o.useRef($),[E,x]=o.useState($),b=o.useRef($),U=()=>{if(!k)return;g(!1);let f=s||i||w.current;S(f,b.current)||(b.current=f,x(f))},[k,g]=o.useState(!1);return o.useEffect(U),{realtimeValidation:c||V||s||i||$,displayValidation:u==="native"?c||V||E:c||V||s||i||E,updateValidation(f){u==="aria"&&!S(E,f)?x(f):w.current=f},resetValidation(){let f=$;S(f,b.current)||(b.current=f,x(f)),u==="native"&&g(!1),p(!0)},commitValidation(){u==="native"&&g(!0),p(!0)}}}function I(e){return e?Array.isArray(e)?e:[e]:[]}function Z(e,t){if(typeof e=="function"){let a=e(t);if(a&&typeof a!="boolean")return I(a)}return[]}function R(e){return e.length?{isInvalid:!0,validationErrors:e,validationDetails:A}:null}function S(e,t){return e===t?!0:!!e&&!!t&&e.isInvalid===t.isInvalid&&e.validationErrors.length===t.validationErrors.length&&e.validationErrors.every((a,r)=>a===t.validationErrors[r])&&Object.entries(e.validationDetails).every(([a,r])=>t.validationDetails[a]===r)}function be(e,t,a){let{validationBehavior:r,focus:n}=e;q(()=>{if(r==="native"&&a?.current&&!a.current.disabled){let s=t.realtimeValidation.isInvalid?t.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";a.current.setCustomValidity(s),a.current.hasAttribute("title")||(a.current.title=""),t.realtimeValidation.isInvalid||t.updateValidation(te(a.current))}});let i=o.useRef(!1),d=y(()=>{i.current||t.resetValidation()}),u=y(s=>{var l;t.displayValidation.isInvalid||t.commitValidation();let v=a==null||(l=a.current)===null||l===void 0?void 0:l.form;if(!s.defaultPrevented&&a&&v&&ae(v)===a.current){var m;n?n():(m=a.current)===null||m===void 0||m.focus(),Q("keyboard")}s.preventDefault()}),c=y(()=>{t.commitValidation()});o.useEffect(()=>{let s=a?.current;if(!s)return;let l=s.form,v=l?.reset;return l&&(l.reset=()=>{i.current=!window.event||window.event.type==="message"&&window.event.target instanceof MessagePort,v?.call(l),i.current=!1}),s.addEventListener("invalid",u),s.addEventListener("change",c),l?.addEventListener("reset",d),()=>{s.removeEventListener("invalid",u),s.removeEventListener("change",c),l?.removeEventListener("reset",d),l&&(l.reset=v)}},[a,r])}function ee(e){let t=e.validity;return{badInput:t.badInput,customError:t.customError,patternMismatch:t.patternMismatch,rangeOverflow:t.rangeOverflow,rangeUnderflow:t.rangeUnderflow,stepMismatch:t.stepMismatch,tooLong:t.tooLong,tooShort:t.tooShort,typeMismatch:t.typeMismatch,valueMissing:t.valueMissing,valid:t.valid}}function te(e){return{isInvalid:!e.validity.valid,validationDetails:ee(e),validationErrors:e.validationMessage?[e.validationMessage]:[]}}function ae(e){for(let t=0;t<e.elements.length;t++){let a=e.elements[t];if(!a.validity.valid)return a}return null}var L=Symbol("default");function ie(e){const t=o.useRef(null),a=o.useRef(void 0),r=o.useCallback(n=>{if(typeof e=="function"){const i=e,d=i(n);return()=>{typeof d=="function"?d():i(null)}}else if(e)return e.current=n,()=>{e.current=null}},[e]);return o.useMemo(()=>({get current(){return t.current},set current(n){t.current=n,a.current&&(a.current(),a.current=void 0),n!=null&&(a.current=r(n))}}),[r])}function re(e,t){let a=o.useContext(e);if(t===null)return null;if(a&&typeof a=="object"&&"slots"in a&&a.slots){let r=new Intl.ListFormat().format(Object.keys(a.slots).map(i=>`"${i}"`));if(!t&&!a.slots[L])throw new Error(`A slot prop is required. Valid slot names are ${r}.`);let n=t||L;if(!a.slots[n])throw new Error(`Invalid slot "${t}". Valid slot names are ${r}.`);return a.slots[n]}return a}function ne(e,t,a){let r=re(a,e.slot)||{},{ref:n,...i}=r,d=ie(o.useMemo(()=>Y(t,n),[t,n])),u=z(i,e);return"style"in i&&i.style&&"style"in e&&e.style&&(typeof i.style=="function"||typeof e.style=="function"?u.style=c=>{let s=typeof i.style=="function"?i.style(c):i.style,l={...c.defaultStyle,...s},v=typeof e.style=="function"?e.style({...c,defaultStyle:l}):e.style;return{...l,...v}}:u.style={...i.style,...e.style}),[u,d]}var F=o.createContext(null),ye=o.forwardRef(function(t,a){[t,a]=ne(t,a,F);let{validationErrors:r,validationBehavior:n="native",children:i,className:d,...u}=t;const c=o.useMemo(()=>G({className:d}),[d]);return h.jsx("form",{noValidate:n!=="native",...u,ref:a,className:c,children:h.jsx(F.Provider,{value:{...t,validationBehavior:n},children:h.jsx(O.Provider,{value:r??{},children:i})})})});export{me as $,F,ve as a,$e as b,be as c,D as d,$ as e,ye as f,re as u};
